"use strict";(self.webpackChunkkeycloakify_starter=self.webpackChunkkeycloakify_starter||[]).push([[90],{"./node_modules/keycloakify/lib/pages/WebauthnAuthenticate.js":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return WebauthnAuthenticate}});var react=__webpack_require__("./node_modules/react/index.js"),clsx=__webpack_require__("./node_modules/keycloakify/lib/tools/clsx.js"),lib=__webpack_require__("./node_modules/rfc4648/lib/index.js");lib.YU,lib.pJ,lib.eV,lib.US;const base64url=lib.tH;lib.Y2;var useConstCallback=__webpack_require__("./node_modules/keycloakify/lib/tools/useConstCallback.js"),__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};function WebauthnAuthenticate(props){const{kcContext:kcContext,i18n:i18n,doFetchDefaultThemeResources:doFetchDefaultThemeResources=!0,Template:Template}=props,kcProps=__rest(props,["kcContext","i18n","doFetchDefaultThemeResources","Template"]),{url:url}=kcContext,{msg:msg,msgStr:msgStr}=i18n,{authenticators:authenticators,challenge:challenge,shouldDisplayAuthenticators:shouldDisplayAuthenticators,userVerification:userVerification,rpId:rpId}=kcContext,createTimeout=Number(kcContext.createTimeout),isUserIdentified="true"==kcContext.isUserIdentified,webAuthnAuthenticate=(0,useConstCallback.O)((async()=>{if(!isUserIdentified)return;const allowCredentials=authenticators.authenticators.map((authenticator=>({id:base64url.parse(authenticator.credentialId,{loose:!0}),type:"public-key"})));if(!window.PublicKeyCredential)return setError(msgStr("webauthn-unsupported-browser-text")),void submitForm();const publicKey={rpId:rpId,challenge:base64url.parse(challenge,{loose:!0})};0!==createTimeout&&(publicKey.timeout=1e3*createTimeout),allowCredentials.length&&(publicKey.allowCredentials=allowCredentials),"not specified"!==userVerification&&(publicKey.userVerification=userVerification);try{const resultRaw=await navigator.credentials.get({publicKey:publicKey});if(!resultRaw||"public-key"!=resultRaw.type)return;const result=resultRaw;if(!("authenticatorData"in result.response))return;const response=result.response,clientDataJSON=response.clientDataJSON,authenticatorData=response.authenticatorData,signature=response.signature;setClientDataJSON(base64url.stringify(new Uint8Array(clientDataJSON),{pad:!1})),setAuthenticatorData(base64url.stringify(new Uint8Array(authenticatorData),{pad:!1})),setSignature(base64url.stringify(new Uint8Array(signature),{pad:!1})),setCredentialId(result.id),setUserHandle(base64url.stringify(new Uint8Array(response.userHandle),{pad:!1})),submitForm()}catch(err){setError(String(err)),submitForm()}})),webAuthForm=(0,react.useRef)(null),submitForm=(0,useConstCallback.O)((()=>{webAuthForm.current.submit()})),[clientDataJSON,setClientDataJSON]=(0,react.useState)(""),[authenticatorData,setAuthenticatorData]=(0,react.useState)(""),[signature,setSignature]=(0,react.useState)(""),[credentialId,setCredentialId]=(0,react.useState)(""),[userHandle,setUserHandle]=(0,react.useState)(""),[error,setError]=(0,react.useState)("");return react.createElement(Template,Object.assign({},Object.assign({kcContext:kcContext,i18n:i18n,doFetchDefaultThemeResources:doFetchDefaultThemeResources},kcProps),{headerNode:msg("webauthn-login-title"),formNode:react.createElement("div",{id:"kc-form-webauthn",className:(0,clsx.W)(kcProps.kcFormClass)},react.createElement("form",{id:"webauth",action:url.loginAction,ref:webAuthForm,method:"post"},react.createElement("input",{type:"hidden",id:"clientDataJSON",name:"clientDataJSON",value:clientDataJSON}),react.createElement("input",{type:"hidden",id:"authenticatorData",name:"authenticatorData",value:authenticatorData}),react.createElement("input",{type:"hidden",id:"signature",name:"signature",value:signature}),react.createElement("input",{type:"hidden",id:"credentialId",name:"credentialId",value:credentialId}),react.createElement("input",{type:"hidden",id:"userHandle",name:"userHandle",value:userHandle}),react.createElement("input",{type:"hidden",id:"error",name:"error",value:error})),react.createElement("div",{className:(0,clsx.W)(kcProps.kcFormGroupClass)},authenticators&&react.createElement("form",{id:"authn_select",className:(0,clsx.W)(kcProps.kcFormClass)},authenticators.authenticators.map((authenticator=>react.createElement("input",{type:"hidden",name:"authn_use_chk",value:authenticator.credentialId,key:authenticator.credentialId})))),authenticators&&shouldDisplayAuthenticators&&react.createElement(react.Fragment,null,authenticators.authenticators.length>1&&react.createElement("p",{className:(0,clsx.W)(kcProps.kcSelectAuthListItemTitle)},msg("webauthn-available-authenticators")),react.createElement("div",{className:(0,clsx.W)(kcProps.kcFormClass)},authenticators.authenticators.map((authenticator=>{var _a;return react.createElement("div",{id:"kc-webauthn-authenticator",className:(0,clsx.W)(kcProps.kcSelectAuthListItemClass)},react.createElement("div",{className:(0,clsx.W)(kcProps.kcSelectAuthListItemIconClass)},react.createElement("i",{className:(0,clsx.W)(null!==(_a=kcProps[authenticator.transports.iconClass])&&void 0!==_a?_a:kcProps.kcWebAuthnDefaultIcon,kcProps.kcSelectAuthListItemIconPropertyClass)})),react.createElement("div",{className:(0,clsx.W)(kcProps.kcSelectAuthListItemBodyClass)},react.createElement("div",{id:"kc-webauthn-authenticator-label",className:(0,clsx.W)(kcProps.kcSelectAuthListItemHeadingClass)},authenticator.label),authenticator.transports&&authenticator.transports.displayNameProperties.length&&react.createElement("div",{id:"kc-webauthn-authenticator-transport",className:(0,clsx.W)(kcProps.kcSelectAuthListItemDescriptionClass)},authenticator.transports.displayNameProperties.map(((transport,index)=>react.createElement(react.Fragment,null,react.createElement("span",null,msg(transport)),index<authenticator.transports.displayNameProperties.length-1&&react.createElement("span",null,", "))))),react.createElement("div",{className:(0,clsx.W)(kcProps.kcSelectAuthListItemDescriptionClass)},react.createElement("span",{id:"kc-webauthn-authenticator-created-label"},msg("webauthn-createdAt-label")),react.createElement("span",{id:"kc-webauthn-authenticator-created"},authenticator.createdAt))),react.createElement("div",{className:(0,clsx.W)(kcProps.kcSelectAuthListItemFillClass)}))})))),react.createElement("div",{id:"kc-form-buttons",className:(0,clsx.W)(kcProps.kcFormButtonsClass)},react.createElement("input",{id:"authenticateWebAuthnButton",type:"button",onClick:webAuthnAuthenticate,autoFocus:!0,value:msgStr("webauthn-doAuthenticate"),className:(0,clsx.W)(kcProps.kcButtonClass,kcProps.kcButtonPrimaryClass,kcProps.kcButtonBlockClass,kcProps.kcButtonLargeClass)}))))}))}},"./node_modules/rfc4648/lib/index.js":function(__unused_webpack_module,exports){function parse(string,encoding,opts){var _opts$out;if(void 0===opts&&(opts={}),!encoding.codes){encoding.codes={};for(var i=0;i<encoding.chars.length;++i)encoding.codes[encoding.chars[i]]=i}if(!opts.loose&&string.length*encoding.bits&7)throw new SyntaxError("Invalid padding");for(var end=string.length;"="===string[end-1];)if(--end,!(opts.loose||(string.length-end)*encoding.bits&7))throw new SyntaxError("Invalid padding");for(var out=new(null!=(_opts$out=opts.out)?_opts$out:Uint8Array)(end*encoding.bits/8|0),bits=0,buffer=0,written=0,_i=0;_i<end;++_i){var value=encoding.codes[string[_i]];if(void 0===value)throw new SyntaxError("Invalid character "+string[_i]);buffer=buffer<<encoding.bits|value,(bits+=encoding.bits)>=8&&(bits-=8,out[written++]=255&buffer>>bits)}if(bits>=encoding.bits||255&buffer<<8-bits)throw new SyntaxError("Unexpected end of data");return out}function stringify(data,encoding,opts){void 0===opts&&(opts={});for(var _opts$pad=opts.pad,pad=void 0===_opts$pad||_opts$pad,mask=(1<<encoding.bits)-1,out="",bits=0,buffer=0,i=0;i<data.length;++i)for(buffer=buffer<<8|255&data[i],bits+=8;bits>encoding.bits;)bits-=encoding.bits,out+=encoding.chars[mask&buffer>>bits];if(bits&&(out+=encoding.chars[mask&buffer<<encoding.bits-bits]),pad)for(;out.length*encoding.bits&7;)out+="=";return out}var base16Encoding={chars:"0123456789ABCDEF",bits:4},base32Encoding={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bits:5},base32HexEncoding={chars:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bits:5},base64Encoding={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bits:6},base64UrlEncoding={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bits:6},base16={parse:function parse$1(string,opts){return parse(string.toUpperCase(),base16Encoding,opts)},stringify:function stringify$1(data,opts){return stringify(data,base16Encoding,opts)}},base32={parse:function parse$1(string,opts){return void 0===opts&&(opts={}),parse(opts.loose?string.toUpperCase().replace(/0/g,"O").replace(/1/g,"L").replace(/8/g,"B"):string,base32Encoding,opts)},stringify:function stringify$1(data,opts){return stringify(data,base32Encoding,opts)}},base32hex={parse:function parse$1(string,opts){return parse(string,base32HexEncoding,opts)},stringify:function stringify$1(data,opts){return stringify(data,base32HexEncoding,opts)}},base64={parse:function parse$1(string,opts){return parse(string,base64Encoding,opts)},stringify:function stringify$1(data,opts){return stringify(data,base64Encoding,opts)}},base64url={parse:function parse$1(string,opts){return parse(string,base64UrlEncoding,opts)},stringify:function stringify$1(data,opts){return stringify(data,base64UrlEncoding,opts)}},codec={parse:parse,stringify:stringify};exports.YU=base16,exports.pJ=base32,exports.eV=base32hex,exports.US=base64,exports.tH=base64url,exports.Y2=codec}}]);